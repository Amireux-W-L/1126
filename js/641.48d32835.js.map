{"version":3,"file":"js/641.48d32835.js","mappings":"0KAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,KAAKF,EAAII,GAAIJ,EAAIK,OAAO,SAASC,GAAM,OAAOJ,EAAG,KAAK,CAACK,IAAID,EAAKE,IAAI,CAACN,EAAG,cAAc,CAACO,MAAM,CAAC,GAAK,CAAEC,KAAM,OAAQC,OAAQ,CAAEC,OAAQN,EAAKE,OAAS,CAACR,EAAIa,GAAGb,EAAIc,GAAGR,EAAKS,WAAW,EAAE,IAAG,IACvQ,EACIC,EAAkB,GCDtB,MAAOC,EAAqB,WACxB,OAAOC,SAASC,gBAAgBC,SAClC,EAEMC,EAAoB,WACxB,OAAOH,SAASC,gBAAgBG,YAClC,EAEMC,EAAwB,WAC5B,OAAOL,SAASC,gBAAgBK,YAClC,ECGF,OACAC,MAAAA,CAAAA,OACAC,OACA,OACArB,MAAAA,GACAsB,KAAAA,EACAC,YAAAA,CACA,CACAC,IAAAA,OACAC,MAAAA,KAEA,CACAD,IAAAA,MACAC,MAAAA,KAEA,CACAD,IAAAA,QACAC,MAAAA,KAEA,CACAD,IAAAA,MACAC,MAAAA,IAEA,CACAD,IAAAA,MACAC,MAAAA,IAEA,CACAD,IAAAA,MACAC,MAAAA,MAGAC,SAAAA,EAEA,EACAC,SAAAA,CACAF,QACA,gCACA,kDACA,GAIAG,MAAAA,CACAJ,IAAAA,CACA,iBACA,6BACA,2BAEA,iBACA,EACAK,WAAAA,IAGAC,UACAC,OAAAA,iBAAAA,SAAAA,KAAAA,KACA,EACAC,QAAAA,CACA,aACA,sBACA,QACAhB,IAAAA,IAAAA,IACA,WACA,cACAiB,QAAAA,IAAAA,OACA,gBACA,YACA,6BACA,4DAEAA,QAAAA,IAAAA,QACA,gBACA,oCACA,CAEA,CACA,GAEAC,YACAH,OAAAA,oBAAAA,SAAAA,KAAAA,KACA,GC9F6P,I,UCQzPI,GAAY,OACd,EACAzC,EACAiB,GACA,EACA,KACA,WACA,MAIF,EAAewB,EAAiB,O","sources":["webpack://vue-router-demo/./src/views/PostListOther.vue","webpack://vue-router-demo/./src/utils/scroll.js","webpack://vue-router-demo/src/views/PostListOther.vue","webpack://vue-router-demo/./src/views/PostListOther.vue?cd0e","webpack://vue-router-demo/./src/views/PostListOther.vue?6bcc"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('ul',_vm._l((_vm.posts),function(post){return _c('li',{key:post.id},[_c('router-link',{attrs:{\"to\":{ name: 'post', params: { postId: post.id } }}},[_vm._v(_vm._s(post.title))])],1)}),0)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// 滚动条顶部的距离\r\nconst  getWindowScrollTop = function () {\r\n    return document.documentElement.scrollTop\r\n  }\r\n  // 文档的高度\r\n  const getDocumentHeight = function () {\r\n    return document.documentElement.scrollHeight\r\n  }\r\n  // 窗口的高度\r\n  const getWindowScrollHeight = function () {\r\n    return document.documentElement.clientHeight\r\n  }\r\n  \r\n  export {getDocumentHeight, getWindowScrollHeight, getWindowScrollTop}","<template>\r\n    <div>\r\n        <ul>\r\n            <li v-for=\"post in posts\" :key=\"post.id\">\r\n                <router-link :to=\"{ name: 'post', params: { postId: post.id } }\">{{\r\n                        post.title\r\n                }}</router-link>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { getDocumentHeight, getWindowScrollHeight,getWindowScrollTop} from '@/utils/scroll';\r\nexport default {\r\n    props: [\"tab\"],\r\n    data() {\r\n        return {\r\n            posts: [],\r\n            page: 1,\r\n            pageNumbers: [\r\n                {\r\n                    tab: \"good\",\r\n                    total: 720,\r\n                },\r\n                {\r\n                    tab: \"all\",\r\n                    total: 280,\r\n                },\r\n                {\r\n                    tab: \"share\",\r\n                    total: 200,\r\n                },\r\n                {\r\n                    tab: \"ask\",\r\n                    total: 80,\r\n                },\r\n                {\r\n                    tab: \"job\",\r\n                    total: 80,\r\n                },\r\n                {\r\n                    tab: \"dev\",\r\n                    total: 280,\r\n                },\r\n            ],\r\n            loading: false,\r\n        };\r\n    },\r\n    computed: {\r\n        total() {\r\n            const tab = this.tab ? this.tab : \"all\";\r\n            return this.pageNumbers.find((ele) => ele.tab === tab).total;\r\n        },\r\n    },\r\n    // 先选择 第5页，然后查看一篇文章，再点击返回 还要看 5\r\n    // 除了上面流程 只要进入到列表页 默认展示的就是 第一页\r\n    watch: {\r\n        tab: {\r\n            async handler(newValue) {\r\n                const res = await this.$http.get(\r\n                    `/topics?tab=${newValue ? newValue : \"all\"}`\r\n                );\r\n                this.posts = res.data;\r\n            },\r\n            immediate: true,\r\n        },\r\n    },\r\n    mounted() {\r\n        window.addEventListener(\"scroll\", this.load);\r\n    },\r\n    methods: {\r\n        async load() {\r\n            if (this.posts.length) {\r\n                const scrollBottom =\r\n                    getDocumentHeight() - getWindowScrollHeight() - getWindowScrollTop();\r\n                if (scrollBottom <= 20) {\r\n                    if (!this.loading) {\r\n                        console.log(\"加载中\");\r\n                        this.loading = true;\r\n                        this.page++;\r\n                        const res = await this.$http.get(\r\n                            `/topics?tab=${this.tab ? this.tab : \"all\"}&page=${this.page}`\r\n                        );\r\n                        console.log(\"加载完毕\");\r\n                        this.loading = false;\r\n                        this.posts = [...this.posts, ...res.data];\r\n                    }\r\n                }\r\n            }\r\n        },\r\n    },\r\n    destroyed() {\r\n        window.removeEventListener(\"scroll\",this.load);\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\nul {\r\n  list-style: none;\r\n}\r\nul li {\r\n  line-height: 50px;\r\n  border-bottom: 1px solid #ccc;\r\n}\r\nul li a {\r\n  text-decoration: none;\r\n  color: #000;\r\n}\r\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PostListOther.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PostListOther.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PostListOther.vue?vue&type=template&id=68350996&scoped=true&\"\nimport script from \"./PostListOther.vue?vue&type=script&lang=js&\"\nexport * from \"./PostListOther.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PostListOther.vue?vue&type=style&index=0&id=68350996&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"68350996\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","_l","posts","post","key","id","attrs","name","params","postId","_v","_s","title","staticRenderFns","getWindowScrollTop","document","documentElement","scrollTop","getDocumentHeight","scrollHeight","getWindowScrollHeight","clientHeight","props","data","page","pageNumbers","tab","total","loading","computed","watch","immediate","mounted","window","methods","console","destroyed","component"],"sourceRoot":""}